// WARNING: this file is auto-generated by the C2 compiler.
// Any changes you make might be lost!

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "c2style.h"
#include "c2vector.h"


static c2vector_vector c2style_targets = { };

static FILE* c2style_recipe = 0;

static int32_t c2style_lSize = 0;

static unsigned char* c2style_recipetxt = 0;

int32_t main(int32_t argc, unsigned char* args[]) {
  c2vector_init(&c2style_targets);
  unsigned char buf[1024];
  printf("started\n");
  while (strcmp(buf, "/") != 0) {
    puts(getcwd(buf, 1024));
    if (access("recipe.txt", R_OK) == 0)
    {
      c2style_recipe = fopen("recipe.txt", "rb");
      if (!c2style_recipe)
      {
        perror("recipe.txt");
        exit(1);
      }
      fseek(c2style_recipe, 00, SEEK_END);
      c2style_lSize = ftell(c2style_recipe);
      rewind(c2style_recipe);
      c2style_recipetxt = calloc(1, c2style_lSize + 1);
      if (!c2style_recipetxt)
      {
        fclose(c2style_recipe);
        fputs("memory alloc fails", stderr);
        exit(1);
      }
      if (fread(c2style_recipetxt, c2style_lSize, 1, c2style_recipe) != 1)
      {
        fclose(c2style_recipe);
        free(c2style_recipetxt);
        fputs("entire read fails", stderr);
        exit(1);
      }
      fclose(c2style_recipe);
      unsigned char* pch = strtok(c2style_recipetxt, "\n");
      while (pch != NULL) {
        puts("----------");
        printf("%s\n", pch);
        pch = strtok(NULL, "\n");
      }
      free(c2style_recipetxt);
    }
    chdir("../");
  }
  return 1;
}

